<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /

    # Security: Block access to sensitive directories
    RewriteRule ^(app|scheme|console|runtime)(/.*|$) - [F]

    # Security: Block access to sensitive files
    <FilesMatch "\.(env|json|xml|log|md|lock|git|ini|bak|sql)$">
        Require all denied
    </FilesMatch>

    # Disable directory browsing
    Options -Indexes

    # Route all requests to index.php
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ index.php?/$1 [QSA,L]
</IfModule>

DirectoryIndex index.php
AddDefaultCharset UTF-8
